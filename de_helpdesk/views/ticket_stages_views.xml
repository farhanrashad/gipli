<?xml version="1.0"?>
<odoo>

    <record id="project_task_type_form_view_inherit" model="ir.ui.view">
        <field name="name">project.task.type.form.view.inherit</field>
        <field name="model">project.task.type</field>
        <field name="inherit_id" ref="project.task_type_edit"/>
        <field name="arch" type="xml">
            <xpath expr="//sheet" position="inside">
                <notebook>
                    <page string="Approvals" name="ticket_approvals" groups="de_helpdesk.group_project_ticket_approvals">
                        <field name="prj_task_type_approval_line" >
                            <tree editable="bottom" string="Ticket Approvals">
                                <field name="ticket_approval_type" column_invisible="1" />
                                <field name="project_id" 
                                    options="{'no_edit':True, 'no_create':True}" 
                                />
                                <field name="group_ids" widget="many2many_tags"
                                    options="{'no_edit':True, 'no_create':True}" 
                                    invisible="ticket_approval_type != 'group' "
                                />
                                <field name="user_ids" widget="many2many_tags"
                                    options="{'no_edit':True, 'no_create':True}" 
                                    invisible="ticket_approval_type != 'user' "
                                />
                            </tree>
                        </field>
                    </page>
                </notebook>
            </xpath>
        </field>
    </record>
    



    <record id="action_ticket_stage" model="ir.actions.act_window">
        <field name="name">Ticket Stages</field>
        <field name="res_model">project.task.type</field>
        <field name="view_mode">tree,kanban,form</field>
        <field name="domain">[
                ('user_id', '=', False),
                ('project_ids.is_helpdesk_team', '=', True)
            ]
        </field>
        <field name="context">{
                'default_project_id': False
            }
        </field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                No stages found. Let's create one!
            </p><p>
                Customize your pipeline to fit your workflow and monitor the status of your tickets as they progress.
            </p>
        </field>
    </record>
    
    <menuitem name="Stages" id="menu_helpdesk_config_ticket_stages"
            parent="menu_helpdesk_config" 
            action="action_ticket_stage"
            sequence="50"
        />
</odoo>