<odoo>
  <data>
    <record id="edit_project_inherit" model="ir.ui.view">
        <field name="name">iedit.project.inherit</field>
        <field name="model">project.project</field>
        <field name="inherit_id" ref="project.edit_project"/>
        <field name="arch" type="xml">
            <!-- hide origional fields -->
            <xpath expr="//header" position="inside">
              <field name="is_helpdesk_team" invisible="1"/>
            </xpath>

            <xpath expr="//header/button" position="attributes">
                <attribute name="invisible">context.get('is_helpdesk_team')</attribute>
            </xpath>
            
            <xpath expr="//div[hasclass('oe_title')]" position="replace">
                <div class="oe_title" invisible="is_helpdesk_team">
                    <h1 class="d-flex flex-row">
                        <field name="is_favorite" nolabel="1" widget="boolean_favorite" class="me-2"/>
                        <field name="name" options="{'line_breaks': False}" widget="text" class="o_text_overflow" placeholder="e.g. Office Party"/>
                    </h1>
                </div>
                <div class="oe_title" invisible="not is_helpdesk_team">
                    <label for="name" string="Name"/>
                    <h1 id="name"><field name="name" options="{'line_breaks': False}" widget="text" placeholder="e.g. Customer Care"/></h1>
                </div>
                <field name="description" 
                    invisible="not is_helpdesk_team"
                    placeholder="Describe your team to your colleagues and customers..."
                    options="{'escape': True}"
                    style="min-height:50px !important;height:50px !important;"
                />
                <field name="company_id" 
                    invisible="not is_helpdesk_team"
                    groups="base.group_multi_company" 
                    required="1" 
                    nolabel="1" 
                    context="{'create': False}"
                />
            </xpath>
              
            <xpath expr="//group[1]" position="attributes">
                <attribute name="invisible">is_helpdesk_team</attribute>
            </xpath>
            <xpath expr="//page[@name='settings']" position="attributes">
                <attribute name="invisible">is_helpdesk_team</attribute>
            </xpath>
            <xpath expr="//page[@name='description']" position="attributes">
                <attribute name="invisible">is_helpdesk_team</attribute>
            </xpath>

            <!-- Add helpdesk sections -->
            <xpath expr="//group[1]" position="after">
            <t invisible="not is_helpdesk_team">
                <h2>Visibility &amp; Assignment </h2>
                    <div class="row mt16 o_settings_container" id="productivity">
                        <setting
                            help="People to whom this team and its tickets will be visible"
                            documentation="/applications/services/helpdesk/overview/getting_started.html#teams-productivity-and-visibility"
                        >
                            <field name="privacy_visibility" class="mt16 o_light_label" widget="radio"/>
                            <div>
                                <span class="text-muted o_row ps-1" invisible="access_instruction_message == ''">
                                    <i class="fa fa-lightbulb-o"/>&amp;nbsp;<field class="align-top d-inline ms-2" name="access_instruction_message" nolabel="1"/>
                                </span>
                            </div>
                            <div>
                                <span class="text-muted o_row ps-1" invisible="privacy_visibility_warning == ''">
                                    <i class="fa fa-warning"/>&amp;nbsp;<field class="align-top d-inline ms-2" name="privacy_visibility_warning" nolabel="1"/>
                                </span>
                            </div>
                        </setting>
                        <div class="col-lg-6">
                            <setting class="col-lg-12">
                                <label for="message_partner_ids"/>
                                <div class="text-muted">
                                    Receive notifications whenever tickets are created, rated or discussed on in this team
                                </div>
                                <div class="mt16">
                                    <span><b>Followers </b></span>
                                    <field name="message_partner_ids" string="Follow All Team's Tickets" widget="many2many_tags_email"/>
                                </div>
                            </setting>
                            <setting class="col-lg-12" help="Automate the assignment of new tickets to the right people, and make sure all tickets are being handled">
                                <field name="auto_assignment"/>
                                <div invisible="not auto_assignment" class="mt16">
                                    <field name="assign_method" class="o_light_label w-100" widget="radio"/>
                                    <div class="mt16">
                                       
                                    </div>
                                </div>
                            </setting>
                        </div>
                    </div>
                    <h2>Automation</h2>
                    <div class="row mt16 o_settings_container" id="automation">
                        <div class="col-lg-6">
                            <setting class="col-lg-12" help="Set approval for tickets: By security groups (pre-defined teams) or by individual Users.">
                                <field name="is_ticket_approvals"/>
                                <div invisible="not is_ticket_approvals" class="mt16">
                                    <field name="ticket_approval_type" 
                                        required="is_ticket_approvals"
                                        class="o_light_label w-100" 
                                        widget="radio"
                                    />
                                </div>
                            </setting>
                            <setting class="col-lg-12" help="Allow users to combine related tickets into one for a more streamlined resolution.">
                                <field name="is_merge_tickets"/>
                            </setting>
                        </div>
                        <div class="col-lg-6">
                            <setting help="Close inactive tickets automatically">
                                <field name="allow_ticket_auto_close"/>
                                <div class="content-group" invisible="not allow_ticket_auto_close">
                                    <div class="mt16">
                                        <label for="close_stage_id"/>
                                        <field name="close_stage_id" class="ms-2 oe_inline" required="allow_ticket_auto_close" context="{'default_project_id': id}"/>
                                    </div>
                                    <div class="mt8">
                                        <strong>After</strong><field name="day_to_close" class="mx-2 oe_inline text-center" required="1"/><span>days of inactivity</span>
                                    </div>
                                    <div class="mt8">
                                        <label for="from_stage_ids"/>
                                        <field name="from_stage_ids" widget="many2many_tags" class="ms-2" context="{'default_project_id': id}"/>
                                    </div>
                                </div>
                            </setting>
                            <setting class="col-lg-12" help="Allow users to reopen tickets for a more streamlined resolution.">
                                <field name="is_reopen_tickets"/>
                            </setting>
                        </div>
                        
                    </div>
                    <h2>Channels</h2>
                    <div class="row mt16 o_settings_container" id="channels">
                        <setting id="alias_channels" help="Create tickets by sending an email to an alias"
                            documentation="/applications/services/helpdesk/overview/receiving_tickets.html">
                            <div class="mt16">
                                <div class="oe_edit_only">
                                    <div class="text-muted">
                                       Create tickets by sending an email to an alias
                                    </div>
                                    <strong>Alias </strong>
                                    <field name="alias_name" class="w-25"/>@
                                    <field name="alias_domain_id" class="oe_inline" placeholder="e.g. domain.com"
                                           options="{'no_create': True, 'no_open': True}"/>

                                    <p invisible="alias_domain_id">
                                        <button name="%(base_setup.action_general_configuration)d" type="action" string="Set an Alias Domain" icon="oi-arrow-right" class="btn-link mt-2"/>
                                    </p>
                                </div>
                            </div>
                        </setting>
                        <setting>
                        </setting>
                    </div>
                    <h2>Help Center</h2>
                    <div class="row mt16 o_settings_container" id="website_form_channel">
                        <setting help="Get tickets through an online form">
                            <field name="allow_submit_ticket_from_web"/>
                        </setting>
                        <setting>
                        </setting>
                    </div>

                    <h2>Track Bill and Time</h2>
                    <div class="row mt16 o_settings_container" id="website_form_channel">
                        <setting help="Get tickets through an online form">
                        </setting>
                        <setting>
                        </setting>
                    </div>

                    <h2>SLA Policies</h2>
                    <div class="row mt16 o_settings_container" id="website_form_channel">
                        <setting id="sla"
                                  help="Make sure tickets are handled on time"
                                  documentation="/applications/services/helpdesk/overview/sla.html">
                            <field name="is_sla"/>
                            <div class="mt16" invisible="not is_sla">
                                <label for="resource_calendar_id"/>
                                <field name="resource_calendar_id" required="is_sla"/>
                            </div>
                        </setting>
                        <setting id="rating" help="Track customer satisfaction on tickets"
                            documentation="/applications/services/helpdesk/overview/ratings.html">
                            <field name="allow_customer_rating"/>
                            <div id="allow_customer_rating" invisible="not allow_customer_rating">
                                <field name="publish_rating" class="oe_inline"/>
                                <label for="publish_rating" string="Publish this team's ratings on your website"/>
                                
                            </div>
                        </setting>
                        <setting id="rating" help="Set an Email Template on Stages">
                            <div class="text-muted">
                                Set an Email Template on Stages
                            </div>
                            <div class="mt-3">
                                <button name="%(action_ticket_stage)d" type="action" string="Set an Email Template on Stages" icon="oi-arrow-right" class="btn-link" context="{'search_default_team_ids': name}"/>
                            </div>
                        </setting>
                    </div>

                    <h2>Self Service</h2>
                    <div class="row mt16 o_settings_container" id="website_form_channel">
                        <setting help="Allow customers to easily close their tickets through the portal for quick resolutions." documentation="/applications/services/helpdesk/advanced/close_tickets.html">
                            <field name="allow_portal_user_close_ticket"/>
                        </setting>
                        
                        <setting help="Allow customers to conveniently reopen their tickets through the portal for further assistance." documentation="/applications/services/helpdesk/advanced/close_tickets.html">
                            <field name="allow_portal_user_reopen_ticket"/>
                        </setting>
                    </div>

                    <h2>After Sales Service <a href="https://www.odoo.com/documentation/17.0/applications/services/helpdesk/advanced/after_sales.html" title="Documentation" class="o_doc_link" target="_blank"></a></h2>
                    <div class="row mt32 o_settings_container" id="after-sales">
                        <setting help="Allow stock returns and refunds">
                            <field name="allow_stock_returns"/>
                        </setting>
                    </div>
            </t>
            </xpath>
        </field>
      </record>

      
      
      <!-- Form view -->
    <!--
    <record id="helpdesk_project_team_form_view" model="ir.ui.view">
        <field name="name">helpdesk.project.team.form.view</field>
        <field name="model">project.project</field>
        <field name="arch" type="xml">
            <form string="Helpdesk" class="">
                <sheet>
                    <widget name="web_ribbon" title="Archived" bg_color="text-bg-danger" invisible="active"/>
                    <div class="oe_title" id='title'>
                        <label for="name" string="Name"/>
                        <h1 id="name"><field name="name" options="{'line_breaks': False}" widget="text" placeholder="e.g. Customer Care"/></h1>
                    </div>
                    <field name="active" invisible="1"/>
                    <field name="company_id" invisible="1"/>
                    <field name="description" placeholder="Describe your team to your colleagues and customers..."/>
                    <field name="company_id" groups="base.group_multi_company" required="1" nolabel="1" context="{'create': False}"/>
                    <h2>Visibility &amp; Assignment </h2>
                    <div class="row mt16 o_settings_container" id="productivity">
                        <setting
                            help="People to whom this team and its tickets will be visible"
                            documentation="/applications/services/helpdesk/overview/getting_started.html#teams-productivity-and-visibility"
                        >
                            <field name="privacy_visibility" class="mt16 o_light_label" widget="radio"/>
                            <div>
                                <span class="text-muted o_row ps-1" invisible="access_instruction_message == ''">
                                    <i class="fa fa-lightbulb-o"/>&amp;nbsp;<field class="align-top d-inline ms-2" name="access_instruction_message" nolabel="1"/>
                                </span>
                            </div>
                            <div>
                                <span class="text-muted o_row ps-1" invisible="privacy_visibility_warning == ''">
                                    <i class="fa fa-warning"/>&amp;nbsp;<field class="align-top d-inline ms-2" name="privacy_visibility_warning" nolabel="1"/>
                                </span>
                            </div>
                        </setting>
                        <div class="col-lg-6">
                            <setting class="col-lg-12">
                                <label for="message_partner_ids"/>
                                <div class="text-muted">
                                    Receive notifications whenever tickets are created, rated or discussed on in this team
                                </div>
                                <div class="mt16">
                                    <span><b>Followers </b></span>
                                    <field name="message_partner_ids" string="Follow All Team's Tickets" widget="many2many_tags_email"/>
                                </div>
                            </setting>
                            <setting class="col-lg-12" help="Automate the assignment of new tickets to the right people, and make sure all tickets are being handled">
                                <field name="auto_assignment"/>
                                <div invisible="not auto_assignment" class="mt16">
                                    <field name="assign_method" class="o_light_label w-100" widget="radio"/>
                                    <div class="mt16">
                                       
                                    </div>
                                </div>
                            </setting>
                        </div>
                    </div>
                    <h2>Automation</h2>
                    <div class="row mt16 o_settings_container" id="automation">
                        <div class="col-lg-6">
                            <setting class="col-lg-12" help="Set approval for tickets: By security groups (pre-defined teams) or by individual Users.">
                                <field name="is_ticket_approvals"/>
                                <div invisible="not is_ticket_approvals" class="mt16">
                                    <field name="ticket_approval_type" 
                                        required="is_ticket_approvals"
                                        class="o_light_label w-100" 
                                        widget="radio"
                                    />
                                </div>
                            </setting>
                            <setting class="col-lg-12" help="Allow users to combine related tickets into one for a more streamlined resolution.">
                                <field name="is_merge_tickets"/>
                            </setting>
                        </div>
                        <div class="col-lg-6">
                            <setting help="Close inactive tickets automatically">
                                <field name="allow_ticket_auto_close"/>
                                <div class="content-group" invisible="not allow_ticket_auto_close">
                                    <div class="mt16">
                                        <label for="close_stage_id"/>
                                        <field name="close_stage_id" class="ms-2 oe_inline" required="allow_ticket_auto_close" context="{'default_project_id': id}"/>
                                    </div>
                                    <div class="mt8">
                                        <strong>After</strong><field name="day_to_close" class="mx-2 oe_inline text-center" required="1"/><span>days of inactivity</span>
                                    </div>
                                    <div class="mt8">
                                        <label for="from_stage_ids"/>
                                        <field name="from_stage_ids" widget="many2many_tags" class="ms-2" context="{'default_project_id': id}"/>
                                    </div>
                                </div>
                            </setting>
                            <setting class="col-lg-12" help="Allow users to reopen tickets for a more streamlined resolution.">
                                <field name="is_reopen_tickets"/>
                            </setting>
                        </div>
                        
                    </div>
                    <h2>Channels</h2>
                    <div class="row mt16 o_settings_container" id="channels">
                        <setting id="alias_channels" help="Create tickets by sending an email to an alias"
                            documentation="/applications/services/helpdesk/overview/receiving_tickets.html">
                            <div class="mt16">
                                <div class="oe_edit_only">
                                    <div class="text-muted">
                                       Create tickets by sending an email to an alias
                                    </div>
                                    <strong>Alias </strong>
                                    <field name="alias_name" class="w-25"/>@
                                    <field name="alias_domain_id" class="oe_inline" placeholder="e.g. domain.com"
                                           options="{'no_create': True, 'no_open': True}"/>

                                    <p invisible="alias_domain_id">
                                        <button name="%(base_setup.action_general_configuration)d" type="action" string="Set an Alias Domain" icon="oi-arrow-right" class="btn-link mt-2"/>
                                    </p>
                                </div>
                            </div>
                        </setting>
                        <setting>
                        </setting>
                    </div>
                    <h2>Help Center</h2>
                    <div class="row mt16 o_settings_container" id="website_form_channel">
                        <setting help="Get tickets through an online form">
                            <field name="allow_submit_ticket_from_web"/>
                        </setting>
                        <setting>
                        </setting>
                    </div>

                    <h2>Track Bill and Time</h2>
                    <div class="row mt16 o_settings_container" id="website_form_channel">
                        <setting help="Get tickets through an online form">
                        </setting>
                        <setting>
                        </setting>
                    </div>

                    <h2>SLA Policies</h2>
                    <div class="row mt16 o_settings_container" id="website_form_channel">
                        <setting id="sla"
                                  help="Make sure tickets are handled on time"
                                  documentation="/applications/services/helpdesk/overview/sla.html">
                            <field name="is_sla"/>
                            <div class="mt16" invisible="not is_sla">
                                <label for="resource_calendar_id"/>
                                <field name="resource_calendar_id" required="is_sla"/>
                            </div>
                        </setting>
                        <setting id="rating" help="Track customer satisfaction on tickets"
                            documentation="/applications/services/helpdesk/overview/ratings.html">
                            <field name="allow_customer_rating"/>
                            <div id="allow_customer_rating" invisible="not allow_customer_rating">
                                <field name="publish_rating" class="oe_inline"/>
                                <label for="publish_rating" string="Publish this team's ratings on your website"/>
                                
                            </div>
                        </setting>
                        <setting id="rating" help="Set an Email Template on Stages">
                            <div class="text-muted">
                                Set an Email Template on Stages
                            </div>
                            <div class="mt-3">
                                <button name="%(action_ticket_stage)d" type="action" string="Set an Email Template on Stages" icon="oi-arrow-right" class="btn-link" context="{'search_default_team_ids': name}"/>
                            </div>
                        </setting>
                    </div>

                    <h2>Self Service</h2>
                    <div class="row mt16 o_settings_container" id="website_form_channel">
                        <setting help="Allow customers to easily close their tickets through the portal for quick resolutions." documentation="/applications/services/helpdesk/advanced/close_tickets.html">
                            <field name="allow_portal_user_close_ticket"/>
                        </setting>
                        
                        <setting help="Allow customers to conveniently reopen their tickets through the portal for further assistance." documentation="/applications/services/helpdesk/advanced/close_tickets.html">
                            <field name="allow_portal_user_reopen_ticket"/>
                        </setting>
                    </div>

                    <h2>After Sales Service <a href="https://www.odoo.com/documentation/17.0/applications/services/helpdesk/advanced/after_sales.html" title="Documentation" class="o_doc_link" target="_blank"></a></h2>
                    <div class="row mt32 o_settings_container" id="after-sales">
                        <setting help="Allow stock returns and refunds">
                            <field name="allow_stock_returns"/>
                        </setting>
                    </div>
                </sheet>
            </form>
        </field>
    </record>
-->
      
    <record id="helpdesk_team_tree_view" model="ir.ui.view">
        <field name="name">helpdesk.team.tree.view</field>
        <field name="model">project.project</field>
        <field name="arch" type="xml">
            <tree string="Helpdesk Team" multi_edit="1" sample="1">
                <field name="name" class="field_name" string="Name"/>
                <field name="company_id" groups="base.group_multi_company" readonly="1" context="{'create': False}"/>
            </tree>
        </field>
    </record>
      
    <record id="action_project_helpdesk_team" model="ir.actions.act_window">
        <field name="name">Helpdesk Teams</field>
        <field name="res_model">project.project</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[
            ('is_helpdesk_team', '=', True),
            ]
        </field>
        <field name="context">{
            'default_is_sla': True,
            'default_is_helpdesk_team': True
            }
        </field>
        <!--
        <field name="view_ids" eval="[(5, 0, 0),
                (0, 0, {'view_mode': 'tree', 'view_id': ref('helpdesk_team_tree_view')}),
                (0, 0, {'view_mode': 'form', 'view_id': ref('helpdesk_project_team_form_view')})]"/>
        -->
        <field name="help" type="html">
          <p class="o_view_nocontent_smiling_face">
                No teams found. Let's create one!
            </p>
            <p>
                Create teams to organize your tickets by expertise or geographical region, and define a different workflow for each team.
            </p>
        </field>
    </record>
<!--
    <record id="helpdesk_team_tree" model="ir.actions.act_window.view">
        <field name="sequence" eval="2"/>
        <field name="view_mode">tree</field>
        <field name="view_id" ref="helpdesk_team_tree_view"/>
        <field name="act_window_id" ref="action_project_helpdesk_team"/>
    </record>
      
    <record id="project_helpdesk_form" model="ir.actions.act_window.view">
        <field name="sequence" eval="3"/>
        <field name="view_mode">form</field>
        <field name="view_id" ref="project_helpdesk_form_view"/>
        <field name="act_window_id" ref="action_project_helpdesk_team"/>
    </record>
    -->  
    <menuitem name="Helpdesk Teams" id="menu_helpdesk_config_teams"
            parent="menu_helpdesk_config" 
            action="action_project_helpdesk_team"
            sequence="20"
        />
  </data>
</odoo>
