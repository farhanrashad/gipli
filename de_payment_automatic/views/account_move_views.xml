<odoo>
    <record id="account_invoice_form_view_inherit" model="ir.ui.view">
        <field name="name">account.invoice.form.view.inherit</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_move_form"/>
        <field name="arch" type="xml">
            <xpath expr="//group[1]/group[2]" position="inside">
                <label for="payment_block_reasons" string="Payment Block" invisible="state != 'posted'"/>
                <div class="o_row g-0 d-flex" invisible="state != 'posted'">          
                    <field name="payment_block_reasons"
                        invisible="state != 'posted'"
                        />
                    <button name="button_mark_payment_unblock" 
                        type="object" 
                        title="Free for Payment" 
                        icon="fa-check-circle" 
                        class="btn btn-success"
                        invisible="payment_block_reasons == 'P' or state != 'posted' or payment_state in ('in_payment','paid')"
                    />
                    <button name="button_mark_payment_block" 
                        type="object" 
                        title="Mark Payment Block" 
                        icon="fa-ban" 
                        class="btn btn-danger"
                        invisible="payment_block_reasons == 'B' or state != 'posted' or payment_state in ('in_payment','paid')"
                    />
                </div>
            </xpath>
        </field>
    </record>

    <record id="account_invoice_tree_view_inherit" model="ir.ui.view">
        <field name="name">account.invoice.tree.view.inherit</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_invoice_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//tree" position="inside">
                <field name="payment_block_reasons"
                    string="Payment Block"
                    widget="badge"
                    decoration-danger="payment_block_reasons == 'B'"
                    decoration-success="payment_block_reasons == 'P'"
                    optional="hide"
                />                
            </xpath>
        </field>
    </record>

    <record id="account_invoice_filter_view_inherit" model="ir.ui.view">
        <field name="name">account.invoice.filter.view.inehrit</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_account_invoice_filter"/>
        <field name="arch" type="xml">
            <xpath expr="//filter[@name='late']" position="after">
                <separator/>
                <filter name="block_payment" string="Block For Payment" domain="[('payment_block_reasons', '=', 'B'), ('payment_state', 'not in', ('in_payment', 'paid'))]"/>
                <filter name="unblock_payment" string="Free For Payment" domain="[('payment_block_reasons', '=', 'F'), ('payment_state', 'not in', ('in_payment', 'paid'))]"/>
            </xpath>
        </field>
    </record>
    
</odoo>
