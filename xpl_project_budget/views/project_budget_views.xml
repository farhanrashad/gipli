<odoo>
  <data>
      <menuitem
            name="Budget"
            id="menu_projects_budget"
            parent="project.menu_main_pm"
            sequence="40"
        />


      <record model="ir.ui.view" id="project_budget_form_view">
            <field name="name">project.budget.form.view</field>
            <field name="model">project.budget</field>
            <field name="arch" type="xml">
                <form string="Project Budget">
                    <header>
                        <button string="Reset to Draft" name="action_budget_draft" invisible="state == 'draft'" type="object" class="btn-primary"/>
                        <button string="Open" name="action_budget_confirm" invisible="state != 'draft'" type="object" class="btn-primary"/>
                        <button string="Done" name="action_budget_done" invisible="state != 'confirmed'" type="object" class="btn-secondary"/>
                        <button string="Cancel Budget" name="action_budget_cancel" invisible="state != 'draft'" type="object" class="btn-secondary"/>
                            
                        <field name="state" widget="statusbar" statusbar_visible="draft,confirmed,done" readonly="1"/>
                    </header>
                    <sheet>
                        <group>
                            <group>
                                <field name="project_id" options="{'no_create': True, 'no_open': True}"/>
                                <field name="user_id" widget="many2one_avatar_user" options="{'no_create': True, 'no_open': True}"/>
                            </group>
                            <group>
                                <label for="start_date" string="Period"/>
                                <div class="o_row">
                                    <field name="start_date" nolabel="1" class="oe_inline" readonly="state != 'draft'"/>
                                    <i class="fa fa-long-arrow-right mx-2" aria-label="to" title="to"/>
                                    <field name="end_date" nolabel="1" class="oe_inline" readonly="state != 'draft'"/>
                                </div>
                                <field name="company_id" groups="base.group_multi_company" options="{'no_create': True, 'no_open': True}"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="Budget Lines" name="budget_lines">
                                <field name="line_ids" colspan="4" nolabel="1" readonly="state != 'draft'">
                                    <list string="Budget Lines" editable="bottom">
                                        <field name="sequence" widget="handle"/>
                                        <field name="product_id" options="{'no_create': True, 'no_open': True}"/>
                                        <field name="quantity" />
                                        <field name="cost" />
                                        <field name="currency_id" column_invisible="True"/>
                                        <field name="total" sum="total"/>
                                        <field name="amount_budget" sum="Budget"/>

                                        <field name="qty_committed" />
                                        <field name="qty_achieved" />
                                        <button type="object" name="action_open_budget_entries" string="Details..." icon="fa-arrow-circle-o-right" column_invisible="parent.state in ('draft','cancel')"/>
                                    </list>
                                </field>
                            </page>
                        </notebook>
                    </sheet>
                     <chatter/>
                </form>
            </field>
        </record>
      
      <record model="ir.actions.act_window" id="action_project_budget">
            <field name="name">Project Budget</field>
            <field name="res_model">project.budget</field>
            <field name="view_mode">list,form</field>
        </record>
        
            <menuitem
                id="menu_projects_budget_budget"
                sequence="1"
                parent="menu_projects_budget"
                action="action_project_budget"/>
      
  </data>
</odoo>
