<odoo>
    <data>
        <!-- <a t-if="service" t-attf-href="/my/services?{{ keep_query() }}">Services</a> -->

        <template id="portal_layout" name="Portal layout: project menu entry" inherit_id="portal.portal_breadcrumbs" priority="40">
            <xpath expr="//ol[hasclass('o_portal_submenu')]" position="inside">
                <t t-if="service">
                    <li class="breadcrumb-item active text-truncate">
                        <!-- <div class="breadcrumb-item active text-truncate col-10 col-lg-12"> -->
                        <a t-attf-href="/my/{{service.id}}">
                            <!-- <a t-if="service" t-attf-href="/my/service/{{service.id}}"> -->
                            <span t-esc="service.name" /> 
                            <!-- <span t-esc="service.header_model_id.name" /> -->
                        </a>
                    </li>
                </t>
                <t t-if="record_id">
                    <li class="breadcrumb-item active text-truncate">
                        
                            <span t-esc="record_id.name" />
                        
                    </li>
                </t>
            </xpath>

        </template>

        <!-- --> 
        <template id="portal_my_home" name="Show Types / Services" customize_show="True" inherit_id="portal.portal_my_home" priority="40">
            <xpath expr="//div[hasclass('o_portal_docs')]" position="inside">
                <t t-set="services" t-value="request.env['hr.service'].sudo().search([('state','=','publish')])"/>
                <t t-foreach="services" t-as="service">
                    <t t-set="service_count" t-value="service.get_record_count(request.env.user)" />
                    <!--
                    <t t-set="service_count" t-value="request.env[service.header_model_id.model].search_count([(service.filter_field_id.name, 'child_of', [request.env.user.partner_id.id]),(service.filter_field_id.name, '=', [request.env.user.partner_id.id])])"/>
                    -->
                    <t t-set="group" t-value="service.sudo().group_id"/>
                    <t t-if="group  &amp;  request.env.user.groups_id">
                        <a class="list-group-item list-group-item-action d-flex align-items-center justify-content-between" t-attf-href="/my/{{service.id}}" title="Invoices &amp; Bills">
                            <span t-esc="service.name" />
                            <t t-esc="0" /> 
                            <span class="badge text-bg-secondary rounded-pill" data-oe-model="ir.ui.view" data-oe-id="1233" data-oe-field="arch" data-oe-xpath="/t[1]/a[1]/t[3]/span[1]" data-placeholder_count="service_count+0">
                                <t t-if='service_count'>
                                    <span t-esc="service_count+0" />
                                </t>
                                <t t-else=''>
                                    <span t-esc="0" /> 
                                </t>
                            </span>
                        </a>
                    </t>
                    <t t-if="not group">
                        <t t-call="portal.portal_docs_entry">
                            <t t-set="title" t-value="service.name"/>
                            <t t-set="url" t-value="'/my/'+str(service.id)"/>
                            <t t-set="count" t-value="0"/>
                            <t t-if='service_count'>
                                <t t-set="placeholder_count" t-value="'service_count'"/>
                                <t t-set="count" t-value="service_count"/>
                            </t>
                            <t t-else=''>
                                <t t-set="placeholder_count" t-value="'count'"/>
                                <t t-set="count" t-value="0"/>
                            </t>
                        </t>
                    </t>
                </t>
            </xpath>
         



        </template>


        <!-- ======================================== -->
        <!-- ===== Portal menu Items Template ======= -->
        <!-- ======================================== -->

        <template id="portal_my_hr_services" name="My Self Services">
            <t t-call="portal.portal_layout">
                <t t-set="breadcrumbs_searchbar" t-value="True"/>
                <t t-call="portal.portal_searchbar">
                    <t t-set="title">Services</t>
                </t>
                <t t-if="not services">
                    <div class="alert alert-warning mt8" role="alert">
                    There are no services.
                    </div>
                </t>
                <t t-if="services" t-call="portal.portal_table">
                    <tbody>
                        <tr t-foreach="services" t-as="service">
                            <td>
                                <a t-attf-href="/my/{{service.id}}">
                                    <!-- <a t-attf-href="/my/service/{{service.id}}"> -->
                                    <span t-field="service.name"/>

                                </a>
                                <br/>
                            </td>
                            <!-- <t t-set="service_counter" t-value="request.env[service.header_model_id.model].search_count([])"/> -->
                            <td class="text-left">
                                <em>
                                    <span t-esc="service.description" />
                                </em>
                            </td>
                            <td class="text-right">
                                <span class="badge badge-secondary badge-pill" data-oe-model="ir.ui.view" data-oe-id="service.get_record_count( user_id)" data-oe-field="arch" data-placeholder_count="service.get_record_count(user_id)">
                                    <t t-esc="service.get_record_count(user_id)" />
                                </span>
                            </td>
                        </tr>
                    </tbody>
                </t>
            </t>
        </template>

        <template id="portal_my_hr_service" name="My Service">
            <t t-call="portal.portal_layout">
                <t t-set="breadcrumbs_searchbar" t-value="True"/>
                <t t-call="portal.portal_searchbar">
                    <t t-set="title">
                        <span t-field="service.name"/>
                    </t>
                </t>
                <t t-call="portal.portal_table">
                    <t t-call="de_portal_hr_service.hr_service_portal_content"/>
                </t>
            </t>
        </template>

        <!-- ======================================== -->
        <!-- ===== Portal Record List Templates ======= -->
        <!-- ======================================== -->
        <template id="portal_my_hr_service_record" name="My Service: Records">
            <t t-call="portal.portal_layout">
                <t t-call="portal.portal_record_layout">
                    <t t-set="card_header">
                        <div class="row no-gutters">
                            <div class="col-12 row">
                                <div t-if="title" class="col-10 col-md-10  text-left">
                                    <span t-if="title" t-esc="title" class="col-8 text-truncate"/>
                                    <small t-if="title" class="text-muted d-none d-md-inline"> (# <span t-field="record_id.sudo().id"/>S)</small>
                                    <a t-if="record_editable and service.is_edit" t-attf-href="/my/model/record/{{service.id}}/{{service.header_model_id.id}}/{{record_id.id}}/1">
                                        <i class="fa fa-edit"></i>
                                    </a>
                                </div>
                                <div class="col-1 col-md-1 flex-grow-0 text-center">
                                    <div class="record_pager btn-group" role="group">
                                        <a role="button" class="btn btn-link" style = "color:#3aadaa" t-attf-onclick="action(type = 'previous', {{service.id}} , {{service.header_model_id.id}} , {{record_id.id}} )">
                                            <i class="fa fa-chevron-left" role="img" aria-label="Previous" title="Previous"></i>
                                        </a>
                                        <a role="button" class="btn btn-link" style = "color:#3aadaa"  t-attf-onclick="action(type = 'next', {{service.id}} , {{service.header_model_id.id}} , {{record_id.id}} )">
                                            <i class="fa fa-chevron-right" role="img" aria-label="Next" title="Next"></i>
                                        </a>
                                    </div>
                                </div>
                                <div class="col-1 col-md-1 d-flex align-items-center justify-content-end">
                                   <t t-if="state">
                                        <div class="ribbon ribbon-primary">
                                            <span t-esc="state"/>
                                        </div>
                                   </t>
                                </div>

                                <div t-if="state" class="col-1 col-md-1 d-flex align-items-center  text-center">
                                    <span t-esc="state" class=" badge badge-pill badge-info" title="Current stage of this entry"/>
                                </div>
                            </div>
                        </div>
                    </t>
                    <t t-set="card_body">
                        <t t-call="de_portal_hr_service.hr_service_record_portal_content"/>
                    </t>
                </t>
                <div t-if="allow_messages" class="mt32">
                    <h4>
                        <strong>Message and communication history</strong>
                    </h4>
                    <t t-call="portal.message_thread">
                        <t t-set="object" t-value="record_id"/>
                        <t t-set="pid" t-value="pid"/>
                        <t t-set="hash" t-value="hash"/>
                    </t>
                </div>
            </t>
        </template>



        <!-- Callable Template -->

        <template id="hr_service_portal_content" name="Service Portal Content">
            <t t-raw="portal_hr_service_dyanmic_page_template"/>
        </template>

        <template id="hr_service_record_portal_content" name="Service Records Portal Content">
            <t t-raw="portal_hr_service_record_dyanmic_page_template"/>
        </template>

    </data>
</odoo>